{% comment %}
  This section is used in the collection template to render collection page
  listing all products within a collection.

  https://shopify.dev/docs/storefronts/themes/architecture/templates/collection
{% endcomment %}
<div class="container my-4">
  <h5 class="text-center pt-serif-regular">{{ collection.description }}</h5>
  <hr>
</div>

<div class="container my-2">
  <div class="row">
    <div class="col-sm-3">
      <form class="filter-form">
        {%- for filter in collection.filters -%}
          <details class="filter-group inconsolata-expanded">
            <summary class="filter-group-summary">
              <span>{{ filter.label }}</span>

              {%- if filter.active_values.size > 0 -%}
                <span>({{ filter.active_values.size }})</span>
              {%- endif -%}
            </summary>

            <div class="filter-group-display">
              <div class="filter-group-display__header">
                <span class="filter-group-display__header-selected">{{ filter.active_values.size }} selected</span>

                {%- if filter.active_values.size > 0 -%}
                  <a href="{{ filter.url_to_remove }}" class="filter-group-display__header-reset">Reset</a>
                {%- endif -%}
              </div>

              {%- case filter.type -%}
                {%- when 'boolean', 'list' -%}
                  <ul class="filter-group-display__list">
                    {%- for filter_value in filter.values -%}
                      <li class="filter-group-display__list-item">
                        <label for="Filter-{{ filter.param_name }}-{{ forloop.index }}">
                          <input
                            type="checkbox"
                            name="{{ filter_value.param_name }}"
                            value="{{ filter_value.value }}"
                            id="Filter-{{ filter.param_name }}-{{ forloop.index }}"
                            {% if filter_value.active -%}
                              checked
                            {%- endif %}
                            {% if filter_value.count == 0 and filter_value.active == false -%}
                              disabled
                            {%- endif %}
                          >
                          {{ filter_value.label }}
                        </label>
                      </li>
                    {%- endfor -%}
                  </ul>

                  <div class="filter-group-display__submit">
                    <input type="submit" value="Apply">
                  </div>
                {%- when 'price_range' -%}
                  <div class="filter-group-display__price-range">
                    <div class="filter-group-display__price-range-from">
                      <span>{{ cart.currency.symbol }}</span>

                      <input
                        name="{{ filter.min_value.param_name }}"
                        id="Filter-{{ filter.min_value.param_name }}"
                        {% if filter.min_value.value -%}
                          value="{{ filter.min_value.value | money_without_currency | replace: ',', '' }}"
                        {%- endif %}
                        type="number"
                        placeholder="0"
                        min="0"
                        max="{{ filter.range_max | money_without_currency | replace: ',', '' }}"
                      >

                      <label for="Filter-{{ filter.min_value.param_name }}">From</label>
                    </div>
                    <div class="filter-group-display__price-range-to">
                      <span>{{ cart.currency.symbol }}</span>

                      <input
                        name="{{ filter.max_value.param_name }}"
                        id="Filter-{{ filter.max_value.param_name }}"
                        {% if filter.max_value.value -%}
                          value="{{ filter.max_value.value | money_without_currency | replace: ',', '' }}"
                        {%- endif %}
                        type="number"
                        placeholder="{{ filter.range_max | money_without_currency | replace: ',', '' }}"
                        min="0"
                        max="{{ filter.range_max | money_without_currency | replace: ',', '' }}"
                      >

                      <label for="Filter-{{ filter.max_value.param_name }}">To</label>
                    </div>
                  </div>

                  <div class="filter-group-display__submit">
                    <input type="submit" value="Apply">
                  </div>
              {%- endcase -%}
            </div>
          </details>
        {%- endfor -%}

        <div class="active-filters">
          <a href="{{ collection.url }}?sort_by={{ collection.sort_by }}" class="active-filters__clear">Clear all</a>

          {%- for filter in collection.filters -%}
            {%- if filter.type == 'price_range' -%}
              {%- if filter.min_value.value != null or filter.max_value.value != null -%}
                <a class="active-filters__remove-filter" href="{{ filter.url_to_remove }}">
                  {%- assign min_value = filter.min_value.value | default: 0 -%}
                  {%- assign max_value = filter.max_value.value | default: filter.range_max -%}
                  {{ min_value | money }} - {{ max_value | money }} X
                </a>
              {%- endif -%}
            {%- else -%}
              {%- for filter_value in filter.active_values -%}
                <a class="active-filters__remove-filter" href="{{ filter_value.url_to_remove }}">
                  {{ filter.label }}: {{ filter_value.label }} X
                </a>
              {%- endfor -%}
            {%- endif -%}
          {%- endfor -%}
        </div>
      </form>
    </div>

    <div class="col">
      <div class="collection-products">
        {% paginate collection.products by 20 %}
          <div class="row">
            {% for product in collection.products %}
              <div class="col col-sm-3 product-listing">
                <div class="collection-product">
                  {% if product.featured_image %}
                    {% render 'image',
                      class: 'collection-product__image',
                      image: product.featured_image,
                      url: product.url,
                      width: 400,
                      height: 400,
                      crop: 'center'
                    %}
                  {% endif %}
                  <div class="collection-product__content inconsolata-expanded">
                    <p class="black-text">{{ product.title | escape | link_to: product.url }}</p>
                    <p>{{ product.price | money }}</p>
                  </div>
                </div>
              </div>
            {% endfor %}

            {{ paginate | default_pagination }}
          </div>
        {% endpaginate %}
      </div>
    </div>
  </div>
</div>
{% stylesheet %}
  .product-listing{
  border: 1px solid black;

  }
  .collection-products {
   /* display: grid;
    grid-template-columns: repeat(auto-fill, minmax(500px, 1fr)); */
  }
  .filter-group{


  }
{% endstylesheet %}

{% schema %}
{
  "name": "t:general.collection",
  "settings": []
}
{% endschema %}
